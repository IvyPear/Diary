import{S as f}from"./index-CP4c1xqB.js";const v={"üò¢":1,"üò°":2,"üò¥":3,"üòä":4,"‚ú®":5},D={"üò¢":"Bu·ªìn","üò°":"T·ª©c gi·∫≠n","üò¥":"M·ªát m·ªèi","üòä":"Vui v·∫ª","‚ú®":"Tuy·ªát v·ªùi"},E={"üòä":"#AEE6E6","üò¢":"#ADD8E6","üò°":"#FFC0CB","üò¥":"#D8BFD8","‚ú®":"#7FC7C7"};class L{static generateWeeklyData(c){const t=["CN","T2","T3","T4","T5","T6","T7"],g=[];for(let h=6;h>=0;h--){const b=new Date;b.setDate(b.getDate()-h);const n=b.toLocaleDateString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit"}),a=c.find(l=>l.date===n);g.push({day:t[b.getDay()],moodValue:a?v[a.mood]||3:0,mood:a?a.mood:"",date:n,hasEntry:!!a})}return g}static drawWeeklyChart(c){const t=document.getElementById(c);if(!t)return;const g=f.get("diaryEntries",[]),h=this.generateWeeklyData(g);if(t.innerHTML="",!h.some(r=>r.hasEntry)){t.innerHTML=`
                <div class="text-center text-soft p-8">
                    <i data-lucide="bar-chart" class="w-12 h-12 mx-auto mb-4 opacity-20"></i>
                    <p>Ch∆∞a c√≥ d·ªØ li·ªáu tu·∫ßn n√†y</p>
                </div>`,typeof lucide<"u"&&lucide.createIcons();return}const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("viewBox","0 0 500 300"),n.setAttribute("width","100%"),n.setAttribute("height","100%"),n.setAttribute("preserveAspectRatio","xMidYMid meet");const a=getComputedStyle(document.body).getPropertyValue("--button-bg").trim(),l=getComputedStyle(document.body).getPropertyValue("--accent").trim(),y=getComputedStyle(document.body).getPropertyValue("--text-soft").trim();h.forEach((r,u)=>{const i=80+u*60,s=r.hasEntry?r.moodValue/5*180:10,e=240-s,o=document.createElementNS("http://www.w3.org/2000/svg","rect");o.setAttribute("x",i-20),o.setAttribute("y",e),o.setAttribute("width","40"),o.setAttribute("height",s),o.setAttribute("fill",r.hasEntry?a:"#E5E7EB"),o.setAttribute("rx","8"),o.setAttribute("opacity",r.hasEntry?"0.8":"0.3"),o.style.transition="all 0.3s ease",o.addEventListener("mouseenter",()=>{o.setAttribute("opacity","1")}),o.addEventListener("mouseleave",()=>{o.setAttribute("opacity",r.hasEntry?"0.8":"0.3")}),n.appendChild(o);const d=document.createElementNS("http://www.w3.org/2000/svg","text");if(d.setAttribute("x",i),d.setAttribute("y","270"),d.setAttribute("text-anchor","middle"),d.setAttribute("fill",y),d.setAttribute("font-weight","bold"),d.textContent=r.day,n.appendChild(d),r.hasEntry&&r.mood&&r.moodValue>0){const m=document.createElementNS("http://www.w3.org/2000/svg","text");m.setAttribute("x",i),m.setAttribute("y",e-10),m.setAttribute("text-anchor","middle"),m.setAttribute("fill",a),m.setAttribute("font-size","20"),m.textContent=r.mood,n.appendChild(m)}});for(let r=1;r<=5;r++){const u=240-r/5*180,i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("x","50"),i.setAttribute("y",u+3),i.setAttribute("text-anchor","end"),i.setAttribute("fill",y),i.setAttribute("font-size","12"),i.textContent=r,n.appendChild(i)}const A=document.createElementNS("http://www.w3.org/2000/svg","line");A.setAttribute("x1","60"),A.setAttribute("y1","240"),A.setAttribute("x2","440"),A.setAttribute("y2","240"),A.setAttribute("stroke",l),A.setAttribute("stroke-width","2"),n.appendChild(A);const p=document.createElementNS("http://www.w3.org/2000/svg","line");p.setAttribute("x1","60"),p.setAttribute("y1","60"),p.setAttribute("x2","60"),p.setAttribute("y2","240"),p.setAttribute("stroke",l),p.setAttribute("stroke-width","2"),n.appendChild(p),t.appendChild(n)}static generateMoodFrequencyData(c){const t={"üò¢":0,"üò°":0,"üò¥":0,"üòä":0,"‚ú®":0};return c.forEach(g=>{t.hasOwnProperty(g.mood)&&t[g.mood]++}),t}static drawPieChart(c){const t=document.getElementById(c);if(!t)return;const g=f.get("diaryEntries",[]),h=this.generateMoodFrequencyData(g),b=Object.values(h).reduce((e,o)=>e+o,0);if(t.innerHTML="",b===0){t.innerHTML=`
                <div class="text-center text-soft p-8">
                    <i data-lucide="pie-chart" class="w-12 h-12 mx-auto mb-4 opacity-20"></i>
                    <p>Ch∆∞a c√≥ d·ªØ li·ªáu</p>
                </div>`,typeof lucide<"u"&&lucide.createIcons();return}const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("viewBox","0 0 200 200"),n.setAttribute("width","200"),n.setAttribute("height","200"),n.setAttribute("class","mx-auto");const a=100,l=100,y=80;let A=0;const p={};Object.entries(h).forEach(([e,o])=>{o>0&&(p[e]=o/b*100)}),Object.entries(p).forEach(([e,o])=>{if(o>0){const d=o/100*360,m=A,M=m+d,x=(m-90)*Math.PI/180,C=(M-90)*Math.PI/180,S=a+y*Math.cos(x),T=l+y*Math.sin(x),k=a+y*Math.cos(C),V=l+y*Math.sin(C),$=d>180?1:0,w=document.createElementNS("http://www.w3.org/2000/svg","path");w.setAttribute("d",`
                    M ${a} ${l}
                    L ${S} ${T}
                    A ${y} ${y} 0 ${$} 1 ${k} ${V}
                    Z
                `),w.setAttribute("fill",E[e]),w.setAttribute("stroke","white"),w.setAttribute("stroke-width","2"),n.appendChild(w),A+=d}});const r=document.createElementNS("http://www.w3.org/2000/svg","circle");r.setAttribute("cx",a),r.setAttribute("cy",l),r.setAttribute("r",y*.3),r.setAttribute("fill","white"),n.appendChild(r);const u=document.createElementNS("http://www.w3.org/2000/svg","text");u.setAttribute("x",a),u.setAttribute("y",l),u.setAttribute("text-anchor","middle"),u.setAttribute("dy","5"),u.setAttribute("font-weight","bold"),u.setAttribute("fill",getComputedStyle(document.body).getPropertyValue("--accent").trim()),u.textContent=b,n.appendChild(u);const i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("x",a),i.setAttribute("y",l+15),i.setAttribute("text-anchor","middle"),i.setAttribute("font-size","10"),i.setAttribute("fill",getComputedStyle(document.body).getPropertyValue("--text-soft").trim()),i.textContent="m·ª•c",n.appendChild(i),t.appendChild(n);const s=document.createElement("div");s.className="mt-6 flex flex-col gap-2",Object.entries(p).forEach(([e,o])=>{if(o>0){const d=h[e],m=document.createElement("div");m.className="flex items-center justify-between",m.innerHTML=`
                    <div class="flex items-center space-x-3">
                        <span class="w-4 h-4 rounded-full" style="background-color: ${E[e]}"></span>
                        <span class="text-sm">${e} ${D[e]}</span>
                    </div>
                    <div class="text-sm font-semibold">${Math.round(o)}% (${d})</div>
                `,s.appendChild(m)}}),t.appendChild(s)}static updateReportStats(){const c=f.get("diaryEntries",[]),t=(s,e)=>{const o=document.getElementById(s);o&&(o.textContent=e)};if(c.length===0){t("most-positive-day","--/--/----"),t("stressful-day","--/--/----"),t("days-written","0"),t("positive-rate","0%"),t("checklist-completed","0%"),t("avg-time","0 ph√∫t"),t("most-frequent-mood","üòä"),t("mood-percentage","0%"),t("most-positive-mood","‚ú®"),t("most-stressful-mood","üò°");return}const g=c.map(s=>{var e;return{date:s.date,mood:s.mood,moodValue:v[s.mood]||3,contentLength:((e=s.content)==null?void 0:e.length)||0}}),h=g.reduce((s,e)=>e.moodValue>s.moodValue?e:s,{moodValue:0,date:"--/--/----",mood:"‚ú®"}),b=g.reduce((s,e)=>e.moodValue<s.moodValue?e:s,{moodValue:6,date:"--/--/----",mood:"üò°"});t("most-positive-day",h.date||"--/--/----"),t("most-positive-mood",h.mood||"‚ú®"),t("stressful-day",b.date||"--/--/----"),t("most-stressful-mood",b.mood||"üò°"),t("days-written",c.length);const n=c.filter(s=>s.mood==="üòä"||s.mood==="‚ú®").length;t("positive-rate",`${Math.round(n/c.length*100)}%`);let a=0,l=0;c.forEach(s=>{var e;a+=6,l+=((e=s.selfCare)==null?void 0:e.length)||0});const y=a>0?Math.round(l/a*100):0;t("checklist-completed",`${y}%`);const A=c.reduce((s,e)=>{var o;return s+(((o=e.content)==null?void 0:o.length)||0)},0),p=c.length>0?A/c.length:0,r=Math.max(1,Math.round(p/50));t("avg-time",`${r} ph√∫t`);const u=this.generateMoodFrequencyData(c),i=Object.values(u).reduce((s,e)=>s+e,0);if(i>0){const s=Object.entries(u).reduce((o,d)=>o[1]>d[1]?o:d),e=Math.round(s[1]/i*100);t("most-frequent-mood",s[0]),t("mood-percentage",`${e}%`)}else t("most-frequent-mood","üòä"),t("mood-percentage","0%")}static drawCharts(){this.drawWeeklyChart("weekly-chart"),this.drawPieChart("pie-chart"),this.updateReportStats()}}export{L as ChartManager};
